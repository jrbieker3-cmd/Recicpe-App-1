<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Meal Planner – Option A</title>

<style>
/* -------------------------
   Base + Utilities
-------------------------- */
:root{
  --ink:#222;
  --bg:#f6f6f8;
  --card:#ffffff;
  --brand:#b39ddb;
  --muted:#6b7280;
  --shadow:0 2px 6px rgba(0,0,0,.08);
  --radius:12px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  margin:0; color:var(--ink); background:var(--bg);
}

/* Buttons */
button{
  display:inline-flex; align-items:center; justify-content:center;
  gap:.5rem; padding:.6rem .9rem; font-size:1rem; border-radius:8px;
  border:2px solid var(--brand); color:var(--brand); background:transparent;
  cursor:pointer; transition:.2s background-color,.2s color;
}
button:hover{ background:var(--brand); color:white; }
button.icon{ width:34px; height:34px; padding:0; border-radius:50%; }

/* Sections (pages) */
.page{ display:none; padding:16px; }
.page.active{ display:block; }

/* -------------------------
   Top Bar
-------------------------- */
.topbar{
  position:sticky; top:0; z-index:10; background:#fff; box-shadow:var(--shadow);
  display:flex; align-items:center; justify-content:space-between; padding:10px 16px;
}
.brand{ font-weight:700; letter-spacing:.2px; }

/* -------------------------
   Planner Header + Controls
-------------------------- */
#plannerPage .panel{
  background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow);
  padding:14px; margin:16px 0;
}
.planner-header{
  display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
}
.planner-title{ font-size:1.4rem; font-weight:700; }

.controls{ display:flex; gap:10px; flex-wrap:wrap; }
.controls label{ font-size:.92rem; color:var(--muted); }
.controls select{
  padding:.55rem .7rem; border:1px solid #E5E7EB; border-radius:8px; background:white;
  font-size:1rem; min-width:140px;
}

/* -------------------------
   Unified Planner Grid
   - Each "dayBlock" contains a label + card
-------------------------- */
#plannerGrid{
  display:grid; gap:12px; margin-top:12px;
  grid-template-columns: repeat(7, minmax(0, 1fr));
}
.dayBlock{
  display:flex; flex-direction:column; gap:8px;
}
.dayLabel{
  text-align:center; font-weight:700; color:#374151;
}
.dayCard{
  background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow);
  padding:10px; display:flex; flex-direction:column; gap:8px; min-height:220px;
}

/* Thumb */
.planner-thumb{
  width:100%; height:140px; object-fit:cover; border-radius:10px; cursor:pointer;
  background:#EFE9FF;
}

/* “Main” row */
.main-row{ display:flex; align-items:center; gap:8px; }
.main-row input[list]{ flex:1; padding:.55rem .6rem; border:1px solid #E5E7EB; border-radius:8px; }

/* Sides */
.sides{ display:flex; flex-direction:column; gap:6px; }
.side-line{ display:flex; align-items:center; gap:6px; }
.side-line input{ flex:1; padding:.5rem .6rem; border:1px solid #E5E7EB; border-radius:8px; }

/* Add side button (full width) */
.side-add-rect{ width:100%; }

/* -------------------------
   Recipe Detail Layout
-------------------------- */
.recipe-detail{
  max-width:1100px; margin:16px auto; padding:0 8px;
}
.recipe-detail-grid{
  display:grid; gap:24px; grid-template-columns: 1fr 320px;
  align-items:start;
}
.recipe-left h2{ margin:.2rem 0 .6rem 0; }
.recipe-left h3{ margin:1rem 0 .3rem 0; }
.recipe-right img{
  width:100%; max-width:320px; height:auto; border-radius:12px; box-shadow:var(--shadow); object-fit:cover;
}
.list{
  margin:0 0 12px 0; padding-left:18px; line-height:1.6;
}
.list-check{
  list-style:none; padding-left:0; margin:0 0 12px 0;
}
.list-check li{ display:flex; align-items:center; gap:8px; margin:.35rem 0; }
.list-check input[type="checkbox"]{ transform:scale(1.1); }

/* -------------------------
   Responsive
-------------------------- */
/* Tablet: show 2–3 columns depending on space */
@media (max-width: 1100px){
  #plannerGrid{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
}
/* Large phones / small tablets: 2 columns */
@media (max-width: 820px){
  #plannerGrid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
  .planner-thumb{ height:120px; }
}
/* Phones: vertical stack (day label then card) */
@media (max-width: 520px){
  #plannerGrid{ grid-template-columns: 1fr; }
  .planner-thumb{ height:110px; }
  .recipe-detail-grid{ grid-template-columns: 1fr; }
  .topbar{ position:fixed; bottom:0; top:auto; }
  body{ padding-bottom:60px; }
}
</style>
</head>

<body>
  <!-- Top Bar -->
  <div class="topbar">
    <div class="brand">Meal Planner</div>
    <div>
      <button onclick="showPage('plannerPage')">Planner</button>
      <button onclick="showPage('recipeDetailPage')">Recipe</button>
    </div>
  </div>

  <!-- =======================
       PLANNER PAGE
  ======================== -->
  <section id="plannerPage" class="page active">
    <div class="panel">
      <div class="planner-header">
        <div class="planner-title">Meal Planner</div>
        <div class="controls">
          <label>Season
            <select id="seasonSelect" onchange="renderPlanner()">
              <option value="Spring/Summer">Spring/Summer</option>
              <option value="Fall/Winter">Fall/Winter</option>
            </select>
          </label>
          <label>Week
            <select id="weekSelect" onchange="renderPlanner()">
              <option value="1">Week 1</option>
              <option value="2">Week 2</option>
              <option value="3">Week 3</option>
              <option value="4">Week 4</option>
              <option value="5">Custom</option>
            </select>
          </label>
          <label>View
            <select id="plannerMode" onchange="renderPlanner()">
              <option value="week">Week View</option>
              <option value="month">Month View</option>
            </select>
          </label>
          <button onclick="startNewRecipe()">Add Recipe</button>
        </div>
      </div>

      <!-- Single unified container -->
      <div id="plannerGrid"></div>
    </div>
  </section>

  <!-- =======================
       RECIPE DETAIL PAGE
  ======================== -->
  <section id="recipeDetailPage" class="page">
    <div class="recipe-detail">
      <div class="recipe-detail-grid">
        <div class="recipe-left">
          <h2 id="detailTitle">Recipe Title</h2>

          <h3>Ingredients</h3>
          <ul id="ingredientChecklist" class="list-check"></ul>

          <h3>Instructions</h3>
          <ol id="instructionList" class="list"></ol>

          <h3>Notes</h3>
          <ul id="notesList" class="list"></ul>
        </div>

        <div class="recipe-right">
          <img id="detailImage" alt="Recipe Image" />
        </div>
      </div>
    </div>
  </section>

<script>
/* ============================
   Minimal Data (replace with your real recipes)
============================ */
const fallbackImage = `data:image/svg+xml;charset=UTF-8,` + encodeURIComponent(
  `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='500'>
     <rect width='100%' height='100%' fill='#efe9ff'/>
     <text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle'
           font-family='Arial' font-size='28' fill='#7856aa'>Add Recipe</text>
   </svg>`
);

const recipes = [
  {
    name: "Teriyaki Beef Noodles",
    image: "https://picsum.photos/seed/nood/800/500",
    ingredients: ["8 oz noodles", "1 lb beef", "1/4 cup teriyaki sauce", "2 cups broccoli"],
    instructions: [
      "Boil noodles until al dente.",
      "Sear beef, add broccoli.",
      "Stir in teriyaki sauce, toss with noodles."
    ],
    notes: ["Great with sesame seeds.", "Meal-prep friendly."]
  },
  {
    name: "Lemon Garlic Chicken",
    image: "https://picsum.photos/seed/chx/800/500",
    ingredients: ["2 chicken breasts", "2 cloves garlic", "1 lemon", "1 tbsp oil"],
    instructions: ["Marinate chicken.", "Sear then roast.", "Rest before slicing."],
    notes: ["Add thyme for aroma."]
  }
];

/* Planner selections persist per season */
const plannerSelections = {
  "Spring/Summer": {},
  "Fall/Winter": {}
};

/* ============================
   Page helpers
============================ */
function showPage(id){
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  const el = document.getElementById(id);
  if (el){ el.classList.add('active'); }
  // Render planner ONLY when planner page is visible
  if(id === 'plannerPage'){ renderPlanner(); }
}

function startNewRecipe(){
  alert("Hook this to your recipe creation flow.");
}

/* Build datalist options from recipes filtered by season if you want */
function recipeOptions(){
  return recipes
    .map(r => `<option value="${escapeHtml(r.name)}"></option>`)
    .join('');
}

function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, m => ({
    '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
  }[m]));
}

/* ============================
   Planner render (UNIFIED GRID)
============================ */
function renderPlanner(){
  const mode  = document.getElementById('plannerMode').value;
  const season= document.getElementById('seasonSelect').value;
  const week  = parseInt(document.getElementById('weekSelect').value, 10);

  const grid = document.getElementById('plannerGrid');
  if(!grid) return;
  grid.innerHTML = '';  // single source of truth, no duplicate grids

  const days = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];

  if(mode === 'week'){
    if(!plannerSelections[season]) plannerSelections[season] = {};

    days.forEach((day, idx) => {
      const dayId = `W${week}D${idx+1}`;
      const dayData = plannerSelections[season][dayId] || {};
      const recipeName = dayData.main || "";

      const block = document.createElement('div');
      block.className = 'dayBlock';

      const label = document.createElement('div');
      label.className = 'dayLabel';
      label.textContent = day;

      const card = document.createElement('div');
      card.className = 'dayCard';
      card.id = dayId;

      card.innerHTML = `
        <img id="${dayId}-img" class="planner-thumb" src="" alt="" />
        <div>
          <div class="main-row">
            <span style="min-width:44px;color:var(--muted)">Main</span>
            <input list="recipeOptions-${dayId}" id="${dayId}-main" value="${escapeHtml(recipeName)}" />
            <datalist id="recipeOptions-${dayId}">${recipeOptions()}</datalist>
            <button class="icon" id="${dayId}-clearBtn" title="Clear" style="display:${recipeName?'inline-flex':'none'}">×</button>
          </div>
        </div>

        <div class="sides" id="${dayId}-sides"></div>
        <button class="side-add-rect" id="${dayId}-addSideBtn">+ Add Side</button>
      `;

      // wire up interactions
      card.querySelector(`#${CSS.escape(dayId)}-main`).addEventListener('change', () => updatePlanner(dayId));
      card.querySelector(`#${CSS.escape(dayId)}-clearBtn`).addEventListener('click', () => clearRecipe(dayId));
      card.querySelector(`#${CSS.escape(dayId)}-addSideBtn`).addEventListener('click', () => addSide(dayId));
      const imgEl = card.querySelector('img');
      imgEl.addEventListener('click', () => handleImageClick(dayId));

      // image selection
      if(recipeName){
        const rec = findRecipe(recipeName);
        imgEl.src = rec?.image || fallbackImage;
        imgEl.alt = rec?.name || 'Recipe';
      }else{
        imgEl.src = fallbackImage;
        imgEl.alt = 'Add Recipe';
      }

      block.appendChild(label);
      block.appendChild(card);
      grid.appendChild(block);
    });
  } else {
    // Month view: 4x7 of simple cards
    for(let w=1; w<=4; w++){
      for(let d=1; d<=7; d++){
        const dayId = `W${w}D${d}`;
        const card = document.createElement('div');
        card.className = 'dayCard';
        card.innerHTML = `
          <div class="dayLabel" style="margin-bottom:4px">Day ${dayId}</div>
          <div class="main-row">
            <span style="min-width:44px;color:var(--muted)">Main</span>
            <select id="${dayId}-main">
              <option value="">—</option>
              ${recipes.map(r=>`<option value="${escapeHtml(r.name)}">${escapeHtml(r.name)}</option>`).join('')}
            </select>
          </div>
          <div class="sides" id="${dayId}-sides"></div>
          <button class="side-add-rect" id="${dayId}-addSideBtn">+ Add Side</button>
        `;
        card.querySelector(`#${CSS.escape(dayId)}-main`).addEventListener('change', () => updatePlanner(dayId));
        card.querySelector(`#${CSS.escape(dayId)}-addSideBtn`).addEventListener('click', () => addSide(dayId));
        grid.appendChild(card);
      }
    }
  }
}

/* ============================
   Planner actions
============================ */
function addSide(dayId){
  const season = document.getElementById('seasonSelect').value;
  if(!plannerSelections[season]) plannerSelections[season] = {};
  if(!plannerSelections[season][dayId]) plannerSelections[season][dayId] = { main:"", sides:[] };

  const sidesWrap = document.getElementById(`${dayId}-sides`);
  if(!sidesWrap) return;

  const idx = plannerSelections[season][dayId].sides.length;
  plannerSelections[season][dayId].sides.push("");

  const row = document.createElement('div');
  row.className = 'side-line';
  row.innerHTML = `
    <input id="${dayId}-side-${idx}" placeholder="Add a side…" />
    <button class="icon" title="Remove">−</button>
  `;
  const input = row.querySelector('input');
  const removeBtn = row.querySelector('button');

  input.addEventListener('change', () => {
    plannerSelections[season][dayId].sides[idx] = input.value;
  });
  removeBtn.addEventListener('click', () => {
    plannerSelections[season][dayId].sides.splice(idx,1);
    row.remove();
  });

  sidesWrap.appendChild(row);
}

function clearRecipe(dayId){
  const season = document.getElementById('seasonSelect').value;
  if(!plannerSelections[season]) return;
  plannerSelections[season][dayId] = { main:"", sides:[] };

  const mainInput = document.getElementById(`${dayId}-main`);
  const imgEl     = document.getElementById(`${dayId}-img`);
  const clearBtn  = document.getElementById(`${dayId}-clearBtn`);
  const sidesWrap = document.getElementById(`${dayId}-sides`);

  if(mainInput) mainInput.value = "";
  if(clearBtn)  clearBtn.style.display = 'none';
  if(imgEl){ imgEl.src = fallbackImage; imgEl.alt = 'Add Recipe'; }
  if(sidesWrap) sidesWrap.innerHTML = "";
}

function updatePlanner(dayId){
  const season = document.getElementById('seasonSelect').value;
  if(!plannerSelections[season]) plannerSelections[season] = {};
  if(!plannerSelections[season][dayId]) plannerSelections[season][dayId] = { main:"", sides:[] };

  const mainInput = document.getElementById(`${dayId}-main`);
  const clearBtn  = document.getElementById(`${dayId}-clearBtn`);
  const imgEl     = document.getElementById(`${dayId}-img`);
  const val = (mainInput?.value || "").trim();

  plannerSelections[season][dayId].main = val;

  if(clearBtn) clearBtn.style.display = val ? 'inline-flex' : 'none';

  const rec = val ? findRecipe(val) : null;
  if(imgEl){
    imgEl.src = rec?.image || fallbackImage;
    imgEl.alt = rec?.name || (val || 'Add Recipe');
  }
}

/* ============================
   Navigation to Recipe Detail
============================ */
function handleImageClick(dayId){
  const season = document.getElementById('seasonSelect').value;
  const info = plannerSelections[season]?.[dayId];
  const name = info?.main?.trim();
  if(!name) return; // nothing selected
  const recipe = findRecipe(name);
  if(!recipe) return;

  // Populate detail page
  document.getElementById('detailTitle').textContent = recipe.name;
  const detailImg = document.getElementById('detailImage');
  detailImg.src = recipe.image || fallbackImage;
  detailImg.alt = recipe.name || "Recipe";

  const ingUL = document.getElementById('ingredientChecklist');
  const insOL = document.getElementById('instructionList');
  const notesUL = document.getElementById('notesList');
  ingUL.innerHTML = insOL.innerHTML = notesUL.innerHTML = "";

  (recipe.ingredients||[]).forEach(txt=>{
    const li = document.createElement('li');
    const cb = document.createElement('input'); cb.type='checkbox';
    const span = document.createElement('span'); span.textContent = txt;
    li.appendChild(cb); li.appendChild(span);
    ingUL.appendChild(li);
  });

  (recipe.instructions||[]).forEach(step=>{
    const li = document.createElement('li'); li.textContent = step; insOL.appendChild(li);
  });

  (recipe.notes||[]).forEach(n=>{
    const li = document.createElement('li'); li.textContent = n; notesUL.appendChild(li);
  });

  showPage('recipeDetailPage');
}

function findRecipe(name){
  const key = (name||"").trim().toLowerCase();
  return recipes.find(r => r.name.trim().toLowerCase() === key);
}

/* ============================
   Init
============================ */
document.addEventListener('DOMContentLoaded', () => {
  showPage('plannerPage'); // will render planner
});
</script>
</body>
</html>
